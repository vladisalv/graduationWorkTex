FILE = termpaper
TEX = pdflatex --shell-escape
BIB = bibtex8 --huge --csfile cp1251rus.csf
#BIB = bibtex
PDF_VIEW = evince

FILE_TEX = $(addprefix $(FILE), .tex)
FILE_AUX = $(addprefix $(FILE), .aux)
FILE_PDF = $(addprefix $(FILE), .pdf)

TEX_FILES = $(wildcard *.tex)

.PHONY: view clean vim print

all: build view

build: $(TEX_FILES)
	@echo "==============================================================================="
	@echo "============================ BEGIN WORK ======================================="
	@echo "==============================================================================="
	@$(TEX) $(FILE_TEX)
	@echo "==============================================================================="
	@echo "======================== FIRST PASSAGE DONE ==================================="
	@echo "==============================================================================="
	@$(BIB) $(FILE_AUX)
	@echo "==============================================================================="
	@echo "=========================== BIBLIO DONE ======================================="
	@echo "==============================================================================="
	@$(TEX) $(FILE_TEX)
	@echo "==============================================================================="
	@echo "======================== SECOND PASSAGE DONE =================================="
	@echo "==============================================================================="
	@$(TEX) $(FILE_TEX)
	@echo "==============================================================================="
	@echo "======================== THIRD PASSAGE DONE ==================================="
	@echo "============================ FINISH WORK ======================================"
	@echo "==============================================================================="

view:
	@$(PDF_VIEW) $(FILE_PDF)

clean:
	@find $(FILE).* | grep -v tex | xargs rm -f

vim:
	@vim -s .vimopen

print:
	@echo "FILE = $(FILE)"
	@echo "FILE_TEX  = $(FILE_TEX)"
	@echo "FILE_AUX  = $(FILE_AUX)"
	@echo "TEX_FILES = $(TEX_FILES)"
